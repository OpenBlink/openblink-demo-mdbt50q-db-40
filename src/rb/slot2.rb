TASK1_BC=[0x52,0x49,0x54,0x45,0x30,0x33,0x30,0x30,0x00,0x00,0x00,0xa8,0x4d,0x41,0x54,0x5a,0x30,0x30,0x30,0x30,0x49,0x52,0x45,0x50,0x00,0x00,0x00,0x8c,0x30,0x33,0x30,0x30,0x00,0x00,0x00,0x80,0x00,0x01,0x00,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x34,0x07,0x02,0x2d,0x01,0x00,0x01,0x15,0x01,0x01,0x2f,0x01,0x02,0x00,0x27,0x01,0x00,0x05,0x11,0x01,0x25,0x00,0x1b,0x1d,0x01,0x03,0x2f,0x01,0x04,0x00,0x27,0x01,0x00,0x04,0x11,0x01,0x39,0x01,0x15,0x01,0x01,0x2f,0x01,0x05,0x00,0x25,0xff,0xe7,0x11,0x01,0x38,0x01,0x69,0x00,0x00,0x00,0x06,0x00,0x08,0x73,0x6c,0x65,0x65,0x70,0x5f,0x6d,0x73,0x00,0x00,0x06,0x24,0x54,0x41,0x53,0x4b,0x31,0x00,0x00,0x04,0x6e,0x69,0x6c,0x3f,0x00,0x00,0x05,0x42,0x6c,0x69,0x6e,0x6b,0x00,0x00,0x0b,0x72,0x65,0x71,0x5f,0x72,0x65,0x6c,0x6f,0x61,0x64,0x3f,0x00,0x00,0x04,0x63,0x61,0x6c,0x6c,0x00,0x45,0x4e,0x44,0x00,0x00,0x00,0x00,0x08].map {|code| code.chr}.join 

#########################
# Task1
$task1_cnt = 29
$TASK1 = Proc.new { 
  $task1_cnt += 1
  if ($task1_cnt % 30) == 0
    $task1_cnt = 0
    ADC.update!
    puts "VDDH:#{ADC.read(0)}V, VDD:#{ADC.read(1)}V, AIN0:#{ADC.read(2)}V"
  end
  sleep_ms 100
}
task1 = Task.create(TASK1_BC)
task1.run

#########################
# Main
led = true
sw2_last = Input.pressed?(part: :sw2)

puts "Hello World!"

while true
  return if Blink.req_reload?

  led = !led
  led = true if Input.pressed?(part: :sw1)
  led = false if Input.pressed?(part: :sw3)
  LED.set(part: :led1, state: led)

  sw2 = Input.pressed?(part: :sw2)
  if sw2_last != sw2
    sw2_last = sw2
    puts (sw2 ? "SW2 pressed" : "SW2 released")
  end

  sleep_ms 500

end
